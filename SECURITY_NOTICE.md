# ⚠️ ВАЖНОЕ УВЕДОМЛЕНИЕ О БЕЗОПАСНОСТИ

## Обнаружена утечка токенов в коммитах

**Дата обнаружения:** 14 февраля 2026 г.

### Что произошло

В файлах `backend/server-rest.js` и `scraper-v2.js` были захардкожены:
- Supabase Project URL
- Supabase Anon Key (JWT токен)

Эти файлы были закоммичены в публичный репозиторий.

### Что нужно сделать НЕМЕДЛЕННО

1. **Ротировать ключи Supabase:**
   - Зайти в [Supabase Dashboard](https://app.supabase.com)
   - Открыть Settings → API
   - Сгенерировать новый Anon key
   - Обновить `.env` файлы на всех серверах

2. **Проверить логи доступа:**
   - Проверить Supabase logs на подозрительную активность
   - Проверить использование API за последние дни

3. **Обновить переменные окружения:**
   - На Render.com: обновить `SUPABASE_KEY`
   - Локально: обновить `backend/.env`

### Что исправлено

- ✅ Удалены захардкоженные токены из `backend/server-rest.js`
- ✅ Добавлена проверка наличия переменных окружения
- ✅ Создан `backend/.env.example` с шаблоном
- ✅ Удалены scraper файлы из git
- ✅ Обновлен `.gitignore` для предотвращения повторных утечек
- ✅ Добавлен скрипт `scripts/prevent-secrets.js` для pre-commit проверки

### Как использовать теперь

1. Создайте `backend/.env` на основе `backend/.env.example`
2. Добавьте реальные значения из Supabase Dashboard
3. НИКОГДА не коммитьте `.env` файлы
4. Используйте переменные окружения на продакшене (Render.com)

### Pre-commit hook

Настроен автоматический скрипт проверки, который блокирует коммиты с токенами.
Если он срабатывает - проверьте файлы перед коммитом!

---

**Важно:** История git содержит старые токены. После ротации они станут недействительными.
